:root{
  --bg:#0f172a; --card:#0b1224; --border:#1f2a44; --text:#e5e7eb; --muted:#a1a1aa;
  --hp:#ef4444; --mp:#3b82f6; --xp1:#22c55e; --xp2:#7c3aed;
}
*{box-sizing:border-box}
body{margin:0; color:var(--text); background:linear-gradient(180deg,#0b1020,#0f172a 40%);
     font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;}
main{padding-top:86px; padding-bottom:76px}
#wrap{max-width:1100px;margin:8px auto 22px;background:var(--card);
      border:1px solid var(--border);border-radius:16px;padding:12px;
      box-shadow:0 20px 60px rgba(0,0,0,.25); position:relative;}
#game{display:block;width:100%;height:auto;border-radius:12px;border:1px solid var(--border);
      background:#0b1224;touch-action:manipulation;image-rendering:pixelated}
.note{color:var(--muted); text-align:center}

/* Overlay */
.overlay{position:fixed;inset:0;display:none;place-items:center;
  background:linear-gradient(180deg,rgba(10,14,28,.9),rgba(10,14,28,.95));z-index:999;}
.overlay.show{display:grid}
.panel{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:22px;
  width:min(90vw,560px);text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.45);}
.logo{margin:6px 0 8px;font-size:34px}
.subtitle{margin:0 0 14px;color:var(--muted)}
.menu{display:flex;flex-direction:column;gap:10px;margin:10px 0}
.btn{background:#1f2a44;color:var(--text);border:1px solid var(--border);border-radius:10px;
  padding:10px 14px;cursor:pointer;}
.btn.primary{background:#7c3aed;border-color:transparent}
.btn.danger{background:#7f1d1d;border-color:#7f1d1d}
.btn:hover{filter:brightness(1.05)}
.options{margin-top:12px;text-align:left;display:grid;gap:8px}

/* HUD */
#hudNostale{position:fixed;top:8px;left:8px;right:260px;display:flex;justify-content:space-between;align-items:center;z-index:10}
.charbox{display:flex;gap:10px;align-items:center;background:rgba(11,18,36,.8);border:1px solid var(--border);border-radius:12px;padding:8px 10px}
.portrait{width:48px;height:48px;border-radius:8px;background:linear-gradient(180deg,#334155,#0b1224);border:1px solid var(--border)}
.bars{min-width:260px}
.bar{position:relative;height:14px;border-radius:999px;border:1px solid rgba(255,255,255,.08);overflow:hidden;margin-bottom:6px;background:#0b1224}
.bar span{position:absolute;inset:0;text-align:center;line-height:14px;font-size:11px}
.bar.hp #hpfill{position:absolute;left:0;top:0;height:100%;background:linear-gradient(90deg,#f87171,var(--hp));width:100%}
.bar.mp #mpfill{position:absolute;left:0;top:0;height:100%;background:linear-gradient(90deg,#60a5fa,var(--mp));width:100%}
.info{display:flex;gap:10px;font-size:12px;color:#e2e8f0;margin-top:2px}
.quickbar{display:flex;gap:6px}
.slot{background:#151c33;color:#cbd5e1;border:1px solid var(--border);border-radius:8px;padding:6px 12px;cursor:pointer}

/* Sidebar destra + pannelli collassabili */
#sidebar{position:fixed;top:8px;right:8px;width:240px;display:flex;flex-direction:column;gap:10px;z-index:10}
.side-panel{background:rgba(11,18,36,.8);border:1px solid var(--border);border-radius:12px;overflow:hidden}
.side-head{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-bottom:1px solid var(--border);font-size:14px}
.tiny{background:#151c33;color:#cbd5e1;border:1px solid var(--border);border-radius:6px;padding:2px 8px;cursor:pointer}
#minimap{width:180px;height:auto;margin:10px;border-radius:8px;border:1px solid var(--border);background:#0b1224}
.side-panel.collapsed{display:none}

/* Quest UI */
.quest{padding:10px}
.q-title{font-weight:700;margin-bottom:6px}
.q-progress{height:10px;background:#111827;border:1px solid #1f2a44;border-radius:999px;overflow:hidden}
#qfill{height:100%;width:0%;background:linear-gradient(90deg,#22c55e,#7c3aed)}
.q-meta{margin-top:6px;color:#cbd5e1;font-size:12px}

/* EXP bar */
#expBar{position:fixed;left:0;right:0;bottom:40px;height:18px;background:#0b1224;border-top:1px solid var(--border);z-index:8}
#xpfill{position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,var(--xp1),var(--xp2));box-shadow:0 0 12px rgba(124,58,237,.6)}
#xptext{position:absolute;left:0;right:0;top:0;text-align:center;line-height:18px;font-weight:700;font-size:12px;color:#fff}

/* Skill bar */
#skillbar{position:fixed;left:50%;transform:translateX(-50%);bottom:6px;height:32px;display:flex;gap:8px;z-index:9}
.skill{position:relative;width:32px;height:32px;border-radius:8px;border:1px solid var(--border);background:#151c33;display:grid;place-items:center;cursor:pointer;overflow:hidden}
.skill img{width:26px;height:26px;image-rendering:pixelated}
.skill .key{position:absolute;left:2px;bottom:2px;font-size:10px;color:#cbd5e1}
.skill .cd{position:absolute;inset:0;background:rgba(0,0,0,.45);height:0%;transition:height .1s linear;}

/* Debug */
.dbg{position:absolute;left:16px;bottom:56px;font:12px/1.2 system-ui;color:#9ca3af;background:rgba(0,0,0,.4);padding:6px 8px;border-radius:8px}
